(this["webpackJsonpnotes-app"]=this["webpackJsonpnotes-app"]||[]).push([[0],{168:function(e,t,n){},169:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(32),o=n.n(c),s=n(8),i=n(20),u=n(21),l=n(10),d=n(28);n(170),n(74);d.a.initializeApp({apiKey:"AIzaSyAu8R2dliBO2nQ3pc5MvX0to1k8t2n7gtQ",authDomain:"react-practices-b915b.firebaseapp.com",databaseURL:"https://react-practices-b915b-default-rtdb.firebaseio.com",projectId:"react-practices-b915b",storageBucket:"react-practices-b915b.appspot.com",messagingSenderId:"350501490135",appId:"1:350501490135:web:c830a5bc1321bd4b22cf92",measurementId:"G-L53B3RPBQG"});var j,b=d.a.firestore(),p=new d.a.auth.GoogleAuthProvider,h=n(9),m=n.n(h),f=n(14),O=n(7),g=n.n(O),x="[Auth] login",v="[Auth] logout",w="[UI] Set Error",y="[UI] Remove Error",N="[UI] Start loading",_="[UI] Finish loading",k="[Notes] Set active note",C="[Notes] Load notes",S="[Notes] Update note",A="[Notes] Delete note",E="[Notes] Logout cleaning",B="[Notes] Update Sidebar",I=function(e){return{type:w,payload:e}},L=function(){return{type:N}},D=function(){return{type:_}},M=n(6),P=function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j=new AbortController,n=j.signal,"https://api.cloudinary.com/v1_1/dtwc8wdqx/upload",(a=new FormData).append("upload_preset","react-app"),a.append("file",t),e.prev=6,e.next=9,fetch("https://api.cloudinary.com/v1_1/dtwc8wdqx/upload",{method:"POST",body:a,signal:n});case 9:if(!(r=e.sent).ok){e.next=17;break}return e.next=13,r.json();case 13:return c=e.sent,e.abrupt("return",c.secure_url);case 17:return e.abrupt("return",null);case 18:e.next=23;break;case 20:return e.prev=20,e.t0=e.catch(6),e.abrupt("return",null);case 23:case"end":return e.stop()}}),e,null,[[6,20]])})));return function(t){return e.apply(this,arguments)}}(),U=function(e){j.abort(),e.target.value=""},W=function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.collection("journal-users/".concat(t,"/notes")).orderBy("date","desc").get();case 3:return n=e.sent,a=[],n.forEach((function(e){a.push(Object(M.a)({id:e.id},e.data()))})),e.abrupt("return",a);case 9:e.prev=9,e.t0=e.catch(0),g.a.fire("Something went wrong",e.t0.message,"error");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),q=function(e){return function(){var t=Object(f.a)(m.a.mark((function t(n,a){var r,c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(g.a.fire({title:"Updating...",allowOutsideClick:!1,showCancelButton:!1,showConfirmButton:!1}),4e3,t.prev=2,!(e.body.length>4e3)){t.next=5;break}throw new Error("Maximum digits per body-note is ".concat(4e3,", your note has ").concat(e.body.length," digits"));case 5:return r=a().auth.uid,e.url||delete e.url,delete(c=Object(M.a)({},e)).id,t.next=11,b.doc("journal-users/".concat(r,"/notes/").concat(e.id)).update(c);case 11:n(G(e.id,c)),g.a.close(),g.a.fire("Saved",e.title,"success"),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(2),g.a.close(),g.a.fire("Error",t.t0.message,"error");case 20:case"end":return t.stop()}}),t,null,[[2,16]])})));return function(e,n){return t.apply(this,arguments)}}()},R=function(e,t){return{type:k,payload:Object(M.a)({id:e},t)}},F=function(e){return{type:C,payload:e}},G=function(e,t){return{type:S,payload:{id:e,note:Object(M.a)({id:e},t)}}},T=function(e){return{type:A,payload:e}},Y=function(e,t){return{type:B,payload:Object(M.a)({id:e},t)}},z=function(e,t){return{type:x,payload:{uid:e,displayName:t}}},Q=function(){return{type:v}},J=n(35),K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(a.useState)(e),n=Object(i.a)(t,2),r=n[0],c=n[1],o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;c(t)},s=function(e){var t=e.target;c(Object(M.a)(Object(M.a)({},r),{},Object(J.a)({},t.name,t.value)))};return[r,s,o]},X=n(1),H=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.ui})).loading,n=K({email:"",password:""}),a=Object(i.a)(n,2),r=a[0],c=a[1],o=r.email,l=r.password;return Object(X.jsxs)(X.Fragment,{children:[Object(X.jsx)("h3",{className:"auth__title",children:"Login"}),Object(X.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(function(e,t){return function(n){return n(L()),d.a.auth().signInWithEmailAndPassword(e,t).then((function(e){var t=e.user;n(z(t.uid,t.displayName)),n(D())})).catch((function(e){g.a.fire("Something went wrong",e.message,"error"),n(D())}))}}(o,l))},children:[Object(X.jsx)("input",{type:"text",placeholder:"Email",name:"email",className:"auth__input",autoComplete:"off",value:o,onChange:c}),Object(X.jsx)("input",{type:"password",placeholder:"Password",name:"password",className:"auth__input",value:l,onChange:c}),Object(X.jsx)("button",{id:"login-btn",type:"submit",className:"btn btn-primary btn-block",disabled:t,children:"Login"}),Object(X.jsxs)("div",{className:"auth__social-networks",children:[Object(X.jsx)("p",{children:"Login with social networks"}),Object(X.jsxs)("div",{id:"google-btn",className:"google-btn",onClick:function(){e((function(e){d.a.auth().signInWithPopup(p).then((function(t){var n=t.user;e(z(n.uid,n.displayName))})).catch((function(e){return g.a.fire("Something went wrong",e.message,"error")}))}))},children:[Object(X.jsx)("div",{className:"google-icon-wrapper",children:Object(X.jsx)("img",{className:"google-icon",src:"https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg",alt:"google button"})}),Object(X.jsx)("p",{className:"btn-text",children:Object(X.jsx)("b",{children:"Sign in with google"})})]})]}),Object(X.jsx)(u.b,{to:"/auth/register",className:"link",children:"Create new account"})]})]})},V=n(64),Z=n.n(V),$=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.ui})),n=t.loading,a=t.msgError,r=K({name:"",email:"",password:"",password2:""}),c=Object(i.a)(r,2),o=c[0],l=c[1],j=o.name,b=o.email,p=o.password,h=o.password2,O=function(){return 0===j.trim().length?(e(I("Invalid Name")),!1):Z.a.isEmail(b)?p!==h||p.length<5?(e(I("password is to short or does not match")),!1):j.trim().length>40?(e(I("Name is too long")),!1):(e({type:y}),!0):(e(I("Invalid Email")),!1)};return Object(X.jsxs)(X.Fragment,{children:[Object(X.jsx)("h3",{className:"auth__title",children:"Register"}),Object(X.jsxs)("form",{onSubmit:function(t){t.preventDefault(),O()&&e(function(e,t,n){return function(a){a(L()),d.a.auth().createUserWithEmailAndPassword(e,t).then(function(){var e=Object(f.a)(m.a.mark((function e(t){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.user,e.next=3,r.updateProfile({displayName:n});case 3:a(z(r.uid,r.displayName)),a(D());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){g.a.fire("Something went wrong",e.message,"error"),a(D())}))}}(b,p,j))},children:[a&&Object(X.jsx)("div",{className:"auth__alert-error",children:a}),Object(X.jsx)("input",{type:"text",placeholder:"Name",name:"name",className:"auth__input",autoComplete:"off",value:j,onChange:l}),Object(X.jsx)("input",{type:"text",placeholder:"Email",name:"email",className:"auth__input",autoComplete:"off",value:b,onChange:l}),Object(X.jsx)("input",{type:"password",placeholder:"Password",name:"password",className:"auth__input",value:p,onChange:l}),Object(X.jsx)("input",{type:"password",placeholder:"Confirm password",name:"password2",className:"auth__input",value:h,onChange:l}),Object(X.jsx)("button",{type:"submit",className:"btn btn-primary btn-block mb-5",disabled:n,children:"Register"}),Object(X.jsx)(u.b,{to:"/auth/login",className:"link",children:"Already registered?"})]})]})},ee=function(){return Object(X.jsx)("div",{className:"auth__main",children:Object(X.jsx)("div",{className:"auth__box-container",children:Object(X.jsxs)(l.d,{children:[Object(X.jsx)(l.b,{exact:!0,path:"/auth/login",component:H}),Object(X.jsx)(l.b,{exact:!0,path:"/auth/register",component:$}),Object(X.jsx)(l.a,{to:"/auth/login"})]})})})},te=n(36),ne=n.n(te),ae=function(e){var t=e.id,n=e.date,a=e.title,r=e.body,c=e.url,o=Object(s.b)(),i=ne()(n),u="";u=a.length>30?a.slice(0,30)+"...":a;var l="";return l=r.length>50?r.slice(0,50)+"...":r,Object(X.jsxs)("div",{className:"journal__entry pointer",onClick:function(){o(R(t,{date:n,title:a,body:r,url:c})),document.querySelector("main").classList.toggle("toggle")},children:[c&&Object(X.jsx)("div",{className:"journal__entry-picture",style:{backgroundSize:"cover",backgroundImage:"url(".concat(c,")")}}),Object(X.jsxs)("div",{className:"journal__entry-body",children:[Object(X.jsx)("p",{className:"journal__entry-title",children:u}),Object(X.jsx)("p",{className:"journal__entry-content",children:l})]}),Object(X.jsxs)("div",{className:"journal__entry-date-box",children:[Object(X.jsx)("span",{children:i.format("MMMM")}),Object(X.jsx)("h4",{children:i.format("Do")})]})]})},re=function(){var e=Object(s.c)((function(e){return e.notes})).notes;return 0===e.length?Object(X.jsx)("div",{style:{textAlign:"center"},className:"journal__entries",children:"Notes..."}):Object(X.jsx)("div",{className:"journal__entries",children:e.map((function(e){return Object(X.jsx)(ae,Object(M.a)({},e),e.id)}))})},ce=r.a.memo((function(e){var t=e.handleAddNote,n=window.innerWidth<650;return window.onresize=function(){n=window.innerWidth<650},n=window.innerWidth<650,Object(X.jsxs)(X.Fragment,{children:[Object(X.jsxs)("div",{className:"journal__new-entry",onClick:t,children:[Object(X.jsx)("i",{className:"far fa-calendar-plus fa-4x"}),Object(X.jsx)("p",{className:"mt-5",children:"New Note"})]}),n&&Object(X.jsx)("button",{className:"btn btn-primary-light",style:{marginTop:"1.2em",padding:".5em 1em",marginBottom:".8em"},onClick:function(){document.querySelector("main").classList.toggle("toggle")},children:"Notes"}),Object(X.jsx)(re,{})]})})),oe=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.auth})).name;return Object(X.jsxs)("aside",{className:"journal__sidebar",children:[Object(X.jsxs)("div",{className:"journal__sidebar-navbar",children:[Object(X.jsxs)("h3",{className:"",children:[Object(X.jsx)("i",{className:"far fa-moon"}),Object(X.jsxs)("span",{children:[" ",t," "]})]}),Object(X.jsx)("button",{className:"btn",onClick:function(){e(function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.auth().signOut();case 3:t(Q()),t({type:E}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),g.a.fire("Something went wrong",e.t0.message,"error");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())},id:"logout-button",children:"Logout"})]}),Object(X.jsx)(ce,{handleAddNote:function(){e(function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g.a.fire({title:"LOADING...",allowOutsideClick:!1,showCancelButton:!1,showConfirmButton:!1}),e.prev=2,!(n().notes.notes.length>=10)){e.next=6;break}throw new Error("Maximum notes per user is ".concat(10));case 6:return a=n().auth.uid,r={title:"",body:"",date:(new Date).getTime()},e.next=10,b.collection("journal-users/".concat(a,"/notes")).add(r);case 10:c=e.sent,t(R(c.id,r)),t(Y(c.id,r)),g.a.close(),g.a.fire("Created, start writing!",r.title,"success"),document.querySelector("main").classList.add("toggle"),e.next=24;break;case 18:return e.prev=18,e.t0=e.catch(2),g.a.close(),g.a.fire("Failed",e.t0.message,"error"),document.querySelector("main").classList.add("toggle"),e.abrupt("return",e.t0.message);case 24:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t,n){return e.apply(this,arguments)}}())}})]})},se=function(){var e=Object(s.c)((function(e){return e.notes})).active,t=Object(s.b)();return Object(X.jsxs)("div",{className:"notes__appbar",id:"appbar",children:[Object(X.jsx)("span",{children:ne()(new Date).format("MMM Do YY")}),Object(X.jsx)("input",{id:"fileSelector",name:"file",type:"file",accept:"image/jpg, image/png, image/jpeg",style:{display:"none"},onChange:function(e){var n=e.target.files[0];(n.name.includes(".png")||n.name.includes(".jpg")||n.name.includes(".jpeg"))&&n.type.startsWith("image")&&e.target.files.length<2?(t(function(e,t){return function(){var n=Object(f.a)(m.a.mark((function n(a,r){var c,o,s;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=!1,g.a.fire({title:"Uploading...",allowOutsideClick:!1,showCancelButton:!1,showConfirmButton:!0,confirmButtonText:"Cancel"}).then((function(e){e.isConfirmed&&(U(t),c=!0)})),n.prev=2,o=r().notes.active,n.next=6,P(e);case 6:s=n.sent,o.url=s,c||a(q(o)),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(2),g.a.fire("Something went wrong",n.t0.message,"error");case 14:case"end":return n.stop()}}),n,null,[[2,11]])})));return function(e,t){return n.apply(this,arguments)}}()}(n,e)),e.target.value=""):(e.target.value="",g.a.fire("Error","The file must be an image, jpg, png or jpeg","error"))}}),Object(X.jsxs)("div",{children:[Object(X.jsx)("button",{className:"btn btn-danger",onClick:function(){var n;t((n=e.id,function(){var e=Object(f.a)(m.a.mark((function e(t,a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g.a.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(){var e=Object(f.a)(m.a.mark((function e(r){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.isConfirmed){e.next=14;break}return g.a.fire({title:"Deleting...",allowOutsideClick:!1,showCancelButton:!1,showConfirmButton:!1}),e.prev=2,c=a().auth.uid,e.next=6,b.doc("journal-users/".concat(c,"/notes/").concat(n)).delete();case 6:t(T(n)),g.a.close(),g.a.fire("Deleted!","Your file has been deleted.","success"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),g.a.fire("Something went wrong",e.t0.message,"error");case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()))},children:"Delete"}),Object(X.jsx)("button",{className:"btn btn-primary",onClick:function(){document.querySelector("#fileSelector").click()},children:"Picture"}),Object(X.jsx)("button",{className:"btn btn-primary",onClick:function(){t(q(e))},children:"Save"})]})]})},ie=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.notes})).active,n=Object(a.useRef)(t.id),r=K(t),c=Object(i.a)(r,3),o=c[0],u=c[1],l=c[2],d=o.body,j=o.title;return Object(a.useEffect)((function(){t.id!==n.current&&(l(t),n.current=t.id)}),[t,l]),Object(a.useEffect)((function(){e(R(o.id,Object(M.a)({},o)))}),[o,e]),Object(X.jsxs)("div",{className:"notes__main-content",children:[Object(X.jsx)(se,{}),Object(X.jsxs)("div",{className:"notes__content",children:[Object(X.jsx)("input",{type:"text",placeholder:"Some cool title",className:"notes__title-input",autoComplete:"off",value:j,name:"title",onChange:u}),Object(X.jsx)("textarea",{placeholder:"What happened today",className:"notes__textarea",value:d,name:"body",onChange:u}),t.url&&Object(X.jsx)("div",{className:"notes__image",children:Object(X.jsx)("a",{rel:"noreferrer",href:t.url,target:"_blank",children:Object(X.jsx)("img",{src:t.url,alt:"imagen"})})})]})]})},ue=function(){return Object(X.jsxs)("div",{className:"nothing__main-content",children:[Object(X.jsxs)("p",{children:["Select something",Object(X.jsx)("br",{}),"or create an entry!"]}),Object(X.jsx)("i",{className:"far fa-star fa-4x mt-5"})]})},le=function(){var e=Object(s.c)((function(e){return e.notes})).active;return Object(X.jsxs)("div",{className:"journal__main-content",children:[Object(X.jsx)(oe,{}),Object(X.jsx)("main",{children:e?Object(X.jsx)(ie,{}):Object(X.jsx)(ue,{})})]})},de=n(37),je=["isAuthenticated","component"],be=function(e){var t=e.isAuthenticated,n=e.component,a=Object(de.a)(e,je);return Object(X.jsx)(l.b,Object(M.a)(Object(M.a)({},a),{},{component:function(e){return t?Object(X.jsx)(n,Object(M.a)({},e)):Object(X.jsx)(l.a,{to:"/auth/login"})}}))},pe=["isAuthenticated","component"],he=function(e){var t=e.isAuthenticated,n=e.component,a=Object(de.a)(e,pe);return Object(X.jsx)(l.b,Object(M.a)(Object(M.a)({},a),{},{component:function(e){return t?Object(X.jsx)(l.a,{to:"/"}):Object(X.jsx)(n,Object(M.a)({},e))}}))},me=function(){var e=Object(s.b)(),t=Object(a.useState)(!0),n=Object(i.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(!1),j=Object(i.a)(o,2),b=j[0],p=j[1];return Object(a.useEffect)((function(){d.a.auth().onAuthStateChanged((function(t){var n;(null===t||void 0===t?void 0:t.uid)?(e(z(t.uid,t.displayName)),p(!0),e((n=t.uid,function(){var e=Object(f.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,W(n);case 3:a=e.sent,t(F(a)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),g.a.fire("Something went wrong",e.t0.message,"error");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))):p(!1),c(!1)}))}),[e]),r?Object(X.jsx)("h2",{style:{color:"white"},children:"Wait"}):Object(X.jsx)(u.a,{children:Object(X.jsx)("div",{children:Object(X.jsxs)(l.d,{children:[Object(X.jsx)(he,{path:"/auth",component:ee,isAuthenticated:b}),Object(X.jsx)(be,{exact:!0,path:"/",component:le,isAuthenticated:b}),Object(X.jsx)(l.a,{to:"/auth/login"})]})})})},fe=n(29),Oe=n(65),ge=n(46),xe={notes:[],active:null},ve={loading:!1,msgError:null},we=fe.c,ye=Object(fe.b)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return{uid:t.payload.uid,name:t.payload.displayName};case v:return{};default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(M.a)(Object(M.a)({},e),{},{msgError:t.payload});case y:return Object(M.a)(Object(M.a)({},e),{},{msgError:null});case N:return Object(M.a)(Object(M.a)({},e),{},{loading:!0});case _:return Object(M.a)(Object(M.a)({},e),{},{loading:!1});default:return e}},notes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object(M.a)(Object(M.a)({},e),{},{active:Object(M.a)({},t.payload)});case C:return Object(M.a)(Object(M.a)({},e),{},{notes:Object(ge.a)(t.payload)});case S:return Object(M.a)(Object(M.a)({},e),{},{notes:e.notes.map((function(e){return e.id===t.payload.id?t.payload.note:e}))});case A:return Object(M.a)(Object(M.a)({},e),{},{active:null,notes:e.notes.filter((function(e){return e.id!==t.payload}))});case B:return Object(M.a)(Object(M.a)({},e),{},{notes:[t.payload].concat(Object(ge.a)(e.notes))});case E:return Object(M.a)({},xe);default:return e}}}),Ne=Object(fe.d)(ye,we(Object(fe.a)(Oe.a))),_e=function(){return Object(X.jsx)(s.a,{store:Ne,children:Object(X.jsx)(me,{})})};n(168);o.a.render(Object(X.jsx)(_e,{}),document.getElementById("root"))}},[[169,1,2]]]);
//# sourceMappingURL=main.f58f44c2.chunk.js.map